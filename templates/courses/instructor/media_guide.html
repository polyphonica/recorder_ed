{% extends 'base.html' %}
{% load static %}

{% block title %}Media Management Guide{% endblock %}

{% block content %}
<div class="section-courses">
    <div class="container mx-auto px-4 py-8 max-w-5xl">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-4xl font-bold text-gray-900">Media Management Guide</h1>
                <a href="{% url 'courses:instructor_dashboard' %}" class="btn btn-ghost">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                </a>
            </div>
            <p class="text-lg text-gray-600">Learn how to organize and upload media files for your courses</p>
        </div>

        <!-- Table of Contents -->
        <div class="card bg-base-200 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title text-2xl mb-4">
                    <i class="fas fa-list mr-2"></i>Table of Contents
                </h2>
                <ul class="menu menu-compact bg-base-100 rounded-box">
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#folder-structure">Folder Structure</a></li>
                    <li><a href="#naming-conventions">Naming Conventions</a></li>
                    <li><a href="#ftp-upload">FTP Upload Process</a></li>
                    <li><a href="#ckeditor-usage">Using Media in CKEditor</a></li>
                    <li><a href="#shared-resources">Shared Resources</a></li>
                    <li><a href="#quick-reference">Quick Reference</a></li>
                    <li><a href="#file-types">File Type Reference</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#best-practices">Best Practices</a></li>
                    <li><a href="#example">Complete Example</a></li>
                </ul>
            </div>
        </div>

        <!-- Overview -->
        <section id="overview" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Overview</h2>
            <div class="prose max-w-none">
                <p class="text-lg">This guide explains how to organize and upload media files (images, audio, PDFs) for your courses using FTP and reference them in your lesson content.</p>
            </div>
        </section>

        <!-- Folder Structure -->
        <section id="folder-structure" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Folder Structure</h2>
            <div class="alert alert-info mb-4">
                <i class="fas fa-info-circle"></i>
                <span>All course media files are organized in a hierarchical structure that mirrors your course organization</span>
            </div>

            <div class="mockup-code mb-6">
                <pre data-prefix="$"><code>media/</code></pre>
                <pre data-prefix="├─"><code>courses/</code></pre>
                <pre data-prefix="│  ├─"><code>images/                  # Course cover images (via Django)</code></pre>
                <pre data-prefix="│  ├─"><code>content/                 # Lesson content (FTP upload)</code></pre>
                <pre data-prefix="│  │  ├─"><code>{course-slug}/</code></pre>
                <pre data-prefix="│  │  │  ├─"><code>{topic-slug}/</code></pre>
                <pre data-prefix="│  │  │  │  ├─"><code>{lesson-slug}/</code></pre>
                <pre data-prefix="│  │  │  │  │  ├─"><code>images/          # SVG, PNG, JPG</code></pre>
                <pre data-prefix="│  │  │  │  │  ├─"><code>audio/           # MP3, WAV, OGG</code></pre>
                <pre data-prefix="│  │  │  │  │  ├─"><code>documents/       # PDFs</code></pre>
                <pre data-prefix="│  │  │  │  │  └─"><code>files/           # Other</code></pre>
                <pre data-prefix="│  │  ├─"><code>shared/              # Shared resources</code></pre>
                <pre data-prefix="│  │  │  ├─"><code>images/</code></pre>
                <pre data-prefix="│  │  │  ├─"><code>audio/</code></pre>
                <pre data-prefix="│  │  │  └─"><code>documents/</code></pre>
                <pre data-prefix="│  ├─"><code>documents/               # Attachments (via model)</code></pre>
                <pre data-prefix="├─"><code>uploads/                     # CKEditor uploads</code></pre>
            </div>

            <div class="card bg-base-100 shadow mb-6">
                <div class="card-body">
                    <h3 class="card-title">Real Example</h3>
                    <p class="mb-2">For course "Recorder Basics - Grade 1" → topic "First Notes" → lesson "Note B":</p>
                    <div class="mockup-code text-sm">
                        <pre data-prefix="$"><code>media/courses/content/</code></pre>
                        <pre data-prefix="└─"><code>recorder-basics-grade-1/</code></pre>
                        <pre data-prefix="    └─"><code>01-first-notes/</code></pre>
                        <pre data-prefix="        └─"><code>01-note-b/</code></pre>
                        <pre data-prefix="            ├─"><code>images/</code></pre>
                        <pre data-prefix="            │   ├─"><code>fingering-chart-b.svg</code></pre>
                        <pre data-prefix="            │   └─"><code>photo-hand-position.jpg</code></pre>
                        <pre data-prefix="            ├─"><code>audio/</code></pre>
                        <pre data-prefix="            │   ├─"><code>note-b-slow.mp3</code></pre>
                        <pre data-prefix="            │   ├─"><code>note-b-medium.mp3</code></pre>
                        <pre data-prefix="            │   └─"><code>note-b-fast.mp3</code></pre>
                        <pre data-prefix="            └─"><code>documents/</code></pre>
                        <pre data-prefix="                └─"><code>sheet-music-note-b.pdf</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Naming Conventions -->
        <section id="naming-conventions" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Naming Conventions</h2>

            <div class="card bg-base-100 shadow mb-6">
                <div class="card-body">
                    <h3 class="card-title">Format</h3>
                    <code class="text-lg">{type}-{descriptor}-{variation}.{ext}</code>

                    <div class="divider"></div>

                    <h4 class="font-bold text-lg mb-2">Examples:</h4>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <h5 class="font-semibold mb-2"><i class="fas fa-image text-primary"></i> Images</h5>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                <li><code>fingering-chart-b.svg</code></li>
                                <li><code>diagram-recorder-parts.svg</code></li>
                                <li><code>photo-hand-position.jpg</code></li>
                            </ul>
                        </div>
                        <div>
                            <h5 class="font-semibold mb-2"><i class="fas fa-volume-up text-secondary"></i> Audio</h5>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                <li><code>note-b-slow.mp3</code></li>
                                <li><code>note-b-fast.mp3</code></li>
                                <li><code>song-demo.mp3</code></li>
                            </ul>
                        </div>
                        <div>
                            <h5 class="font-semibold mb-2"><i class="fas fa-file-pdf text-accent"></i> Documents</h5>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                <li><code>sheet-music-song.pdf</code></li>
                                <li><code>worksheet-practice.pdf</code></li>
                                <li><code>handout-care.pdf</code></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    <div>
                        <h4 class="font-bold">Do:</h4>
                        <ul class="list-disc list-inside text-sm">
                            <li>Use lowercase letters</li>
                            <li>Use hyphens (-) for spaces</li>
                            <li>Be descriptive but concise</li>
                            <li>Include variations (slow/fast)</li>
                        </ul>
                    </div>
                </div>
                <div class="alert alert-error">
                    <i class="fas fa-times-circle"></i>
                    <div>
                        <h4 class="font-bold">Don't:</h4>
                        <ul class="list-disc list-inside text-sm">
                            <li>Use spaces: <code>note b slow.mp3</code></li>
                            <li>Use special chars: <code>note_b@slow!.mp3</code></li>
                            <li>Use generic names: <code>audio1.mp3</code></li>
                            <li>Use uppercase: <code>Note-B-Slow.MP3</code></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- FTP Upload -->
        <section id="ftp-upload" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">FTP Upload Process</h2>

            <div class="steps steps-vertical lg:steps-horizontal mb-6">
                <div class="step step-primary">Connect to Server</div>
                <div class="step step-primary">Navigate to Folder</div>
                <div class="step step-primary">Create Structure</div>
                <div class="step step-primary">Upload Files</div>
                <div class="step step-primary">Verify</div>
            </div>

            <div class="card bg-base-100 shadow mb-6">
                <div class="card-body">
                    <h3 class="card-title">
                        <i class="fas fa-server mr-2"></i>FTP Connection Details
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="table table-zebra">
                            <tbody>
                                <tr>
                                    <th>Host</th>
                                    <td><code>ftp.recorder-ed.com</code> (or server IP)</td>
                                </tr>
                                <tr>
                                    <th>Username</th>
                                    <td><em>Your FTP username</em></td>
                                </tr>
                                <tr>
                                    <th>Password</th>
                                    <td><em>Your FTP password</em></td>
                                </tr>
                                <tr>
                                    <th>Port</th>
                                    <td>21 (or 22 for SFTP)</td>
                                </tr>
                                <tr>
                                    <th>Path</th>
                                    <td><code>/home/[username]/recorder_ed/media/courses/content/</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="alert alert-info">
                <i class="fas fa-lightbulb"></i>
                <div>
                    <h4 class="font-bold">Recommended FTP Clients</h4>
                    <p class="text-sm">FileZilla (Free, All OS) • Cyberduck (Free, Mac/Win) • Transmit (Paid, Mac) • WinSCP (Free, Windows)</p>
                </div>
            </div>
        </section>

        <!-- CKEditor Usage -->
        <section id="ckeditor-usage" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Using Media in CKEditor</h2>

            <div class="card bg-base-100 shadow mb-6">
                <div class="card-body">
                    <h3 class="card-title">File URL Pattern</h3>
                    <code class="block bg-base-200 p-4 rounded">/media/courses/content/{course-slug}/{topic-slug}/{lesson-slug}/{type}/{filename}</code>
                </div>
            </div>

            <div class="tabs tabs-boxed mb-4">
                <a class="tab tab-active" onclick="showTab('images-tab')">Images</a>
                <a class="tab" onclick="showTab('audio-tab')">Audio</a>
                <a class="tab" onclick="showTab('downloads-tab')">Downloads</a>
            </div>

            <div id="images-tab" class="tab-content">
                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h4 class="card-title">Inserting Images</h4>
                        <div class="mockup-code">
                            <pre data-prefix="1"><code>&lt;figure class="image"&gt;</code></pre>
                            <pre data-prefix="2"><code>    &lt;img src="/media/courses/content/..."</code></pre>
                            <pre data-prefix="3"><code>         alt="Description"</code></pre>
                            <pre data-prefix="4"><code>         style="max-width: 100%; height: auto;"&gt;</code></pre>
                            <pre data-prefix="5"><code>    &lt;figcaption&gt;Caption text&lt;/figcaption&gt;</code></pre>
                            <pre data-prefix="6"><code>&lt;/figure&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>

            <div id="audio-tab" class="tab-content hidden">
                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h4 class="card-title">Inserting Audio Players</h4>
                        <div class="mockup-code">
                            <pre data-prefix="1"><code>&lt;div class="audio-player"&gt;</code></pre>
                            <pre data-prefix="2"><code>    &lt;h4&gt;Listen: Note B (Slow)&lt;/h4&gt;</code></pre>
                            <pre data-prefix="3"><code>    &lt;audio controls&gt;</code></pre>
                            <pre data-prefix="4"><code>        &lt;source src="/media/courses/content/..." type="audio/mpeg"&gt;</code></pre>
                            <pre data-prefix="5"><code>    &lt;/audio&gt;</code></pre>
                            <pre data-prefix="6"><code>&lt;/div&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>

            <div id="downloads-tab" class="tab-content hidden">
                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h4 class="card-title">Downloadable Links</h4>
                        <div class="mockup-code">
                            <pre data-prefix="1"><code>&lt;a href="/media/courses/content/..."</code></pre>
                            <pre data-prefix="2"><code>   download</code></pre>
                            <pre data-prefix="3"><code>   class="btn btn-primary"&gt;</code></pre>
                            <pre data-prefix="4"><code>    &lt;i class="fas fa-download"&gt;&lt;/i&gt; Download PDF</code></pre>
                            <pre data-prefix="5"><code>&lt;/a&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Reference -->
        <section id="quick-reference" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Quick Reference</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card bg-gradient-to-br from-primary to-secondary text-primary-content shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title">Finding Your Slugs</h3>
                        <ul class="space-y-2">
                            <li><strong>Course:</strong> Check URL <code class="text-white">/courses/SLUG/</code></li>
                            <li><strong>Topic:</strong> Usually <code class="text-white">{number}-{name}</code></li>
                            <li><strong>Lesson:</strong> Usually <code class="text-white">{number}-{name}</code></li>
                        </ul>
                    </div>
                </div>

                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title">Template to Copy</h3>
                        <div class="text-xs">
                            <p class="mb-2"><strong>Image:</strong></p>
                            <code class="block bg-base-200 p-2 rounded mb-2">&lt;img src="/media/courses/content/COURSE/TOPIC/LESSON/images/FILE.svg" alt="DESC"&gt;</code>

                            <p class="mb-2"><strong>Audio:</strong></p>
                            <code class="block bg-base-200 p-2 rounded">&lt;audio controls&gt;&lt;source src="/media/courses/content/.../FILE.mp3" type="audio/mpeg"&gt;&lt;/audio&gt;</code>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- File Types -->
        <section id="file-types" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">File Type Reference</h2>

            <div class="overflow-x-auto">
                <table class="table table-zebra">
                    <thead>
                        <tr>
                            <th>Extension</th>
                            <th>Type</th>
                            <th>Use Case</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>.svg</code></td>
                            <td><span class="badge badge-primary">Image</span></td>
                            <td>Diagrams, charts, fingering charts</td>
                            <td>Vector graphics, scales perfectly</td>
                        </tr>
                        <tr>
                            <td><code>.jpg</code></td>
                            <td><span class="badge badge-primary">Image</span></td>
                            <td>Photos</td>
                            <td>Good compression for photos</td>
                        </tr>
                        <tr>
                            <td><code>.png</code></td>
                            <td><span class="badge badge-primary">Image</span></td>
                            <td>Screenshots, transparency</td>
                            <td>Lossless quality</td>
                        </tr>
                        <tr>
                            <td><code>.mp3</code></td>
                            <td><span class="badge badge-secondary">Audio</span></td>
                            <td>Audio examples</td>
                            <td>Best compatibility (recommended)</td>
                        </tr>
                        <tr>
                            <td><code>.ogg</code></td>
                            <td><span class="badge badge-secondary">Audio</span></td>
                            <td>Audio examples</td>
                            <td>Open source, good quality</td>
                        </tr>
                        <tr>
                            <td><code>.pdf</code></td>
                            <td><span class="badge badge-accent">Document</span></td>
                            <td>Sheet music, worksheets</td>
                            <td>Universal format (recommended)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Troubleshooting -->
        <section id="troubleshooting" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Troubleshooting</h2>

            <div class="join join-vertical w-full">
                <div class="collapse collapse-arrow join-item border border-base-300">
                    <input type="radio" name="troubleshooting-accordion" checked="checked" />
                    <div class="collapse-title text-lg font-medium">
                        Files Not Appearing (404 Error)
                    </div>
                    <div class="collapse-content">
                        <ul class="list-disc list-inside space-y-2">
                            <li>Check file path is exactly correct (case-sensitive)</li>
                            <li>Verify file was uploaded to correct folder</li>
                            <li>Check file permissions (644 for files, 755 for folders)</li>
                            <li>Try accessing directly in browser</li>
                        </ul>
                    </div>
                </div>

                <div class="collapse collapse-arrow join-item border border-base-300">
                    <input type="radio" name="troubleshooting-accordion" />
                    <div class="collapse-title text-lg font-medium">
                        SVG Not Displaying
                    </div>
                    <div class="collapse-content">
                        <ul class="list-disc list-inside space-y-2">
                            <li>Check SVG file is valid (open in browser locally first)</li>
                            <li>Ensure SVG doesn't have embedded scripts</li>
                            <li>Try viewing directly: add domain before path</li>
                        </ul>
                    </div>
                </div>

                <div class="collapse collapse-arrow join-item border border-base-300">
                    <input type="radio" name="troubleshooting-accordion" />
                    <div class="collapse-title text-lg font-medium">
                        Audio Not Playing
                    </div>
                    <div class="collapse-content">
                        <ul class="list-disc list-inside space-y-2">
                            <li>Check file path is correct</li>
                            <li>Verify audio file isn't corrupted (test locally)</li>
                            <li>Check file format is supported (MP3 is safest)</li>
                            <li>Try including multiple format sources</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Best Practices -->
        <section id="best-practices" class="mb-12">
            <h2 class="text-3xl font-bold mb-4 text-primary">Best Practices</h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h3 class="card-title text-sm">
                            <i class="fas fa-compress text-primary"></i>
                            File Optimization
                        </h3>
                        <ul class="text-sm space-y-1">
                            <li>SVG: Under 200KB</li>
                            <li>Images: Resize before upload</li>
                            <li>Audio: 128-192 kbps MP3</li>
                            <li>PDFs: Web-optimized</li>
                        </ul>
                    </div>
                </div>

                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h3 class="card-title text-sm">
                            <i class="fas fa-universal-access text-secondary"></i>
                            Accessibility
                        </h3>
                        <ul class="text-sm space-y-1">
                            <li>Always use alt text</li>
                            <li>Caption important diagrams</li>
                            <li>Provide audio transcripts</li>
                            <li>Descriptive labels</li>
                        </ul>
                    </div>
                </div>

                <div class="card bg-base-100 shadow">
                    <div class="card-body">
                        <h3 class="card-title text-sm">
                            <i class="fas fa-tasks text-accent"></i>
                            Organization
                        </h3>
                        <ul class="text-sm space-y-1">
                            <li>Create folders first</li>
                            <li>Upload in batches</li>
                            <li>Test in draft lessons</li>
                            <li>Keep local backups</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary Checklist -->
        <div class="card bg-gradient-to-br from-success to-accent text-success-content shadow-2xl mb-8">
            <div class="card-body">
                <h3 class="card-title text-2xl">
                    <i class="fas fa-check-double mr-2"></i>Summary Checklist
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                    <div>
                        <h4 class="font-bold mb-2">Before Upload:</h4>
                        <ul class="space-y-1 text-sm">
                            <li>☑ Files properly named</li>
                            <li>☑ Files optimized</li>
                            <li>☑ Know your slugs</li>
                            <li>☑ FTP connected</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">During Upload:</h4>
                        <ul class="space-y-1 text-sm">
                            <li>☑ Folder structure correct</li>
                            <li>☑ Files in right subfolders</li>
                            <li>☑ Permissions set</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">After Upload:</h4>
                        <ul class="space-y-1 text-sm">
                            <li>☑ Test URLs in browser</li>
                            <li>☑ Add to lesson content</li>
                            <li>☑ Preview as student</li>
                            <li>☑ Check on mobile</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Actions -->
        <div class="flex justify-between items-center mt-8 pt-8 border-t">
            <a href="{% url 'courses:instructor_dashboard' %}" class="btn btn-ghost">
                <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
            </a>
            <div class="text-sm text-gray-600">
                <i class="fas fa-calendar mr-1"></i>Last updated: January 2025
            </div>
        </div>
    </div>
</div>

<script>
function showTab(tabId) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });

    // Remove active class from all tabs
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('tab-active');
    });

    // Show selected tab
    document.getElementById(tabId).classList.remove('hidden');

    // Add active class to clicked tab
    event.target.classList.add('tab-active');
}
</script>
{% endblock %}
