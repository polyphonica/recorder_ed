{% extends "base.html" %}
{% load humanize %}

{% block title %}Confirm Your Registration - {{ workshop.title }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-2xl">
    {% if error %}
        <div class="alert alert-error">
            <div>
                <i class="fas fa-exclamation-circle"></i>
                <span>{{ error }}</span>
            </div>
        </div>
        <div class="text-center mt-8">
            <a href="{% url 'workshops:list' %}" class="btn btn-primary">Browse Workshops</a>
        </div>
    {% elif is_expired %}
        <div class="alert alert-warning">
            <div>
                <i class="fas fa-clock"></i>
                <span>This promotion has expired. The deadline was {{ promotion.expires_at|date:"F j, Y" }} at {{ promotion.expires_at|time:"g:i A" }}.</span>
            </div>
        </div>
        <div class="text-center mt-8">
            <h2 class="text-2xl font-bold mb-4">Promotion Expired</h2>
            <p class="mb-6">Unfortunately, you missed the deadline to confirm your spot. The position has been offered to the next person on the waitlist.</p>
            <a href="{% url 'workshops:detail' workshop.slug %}" class="btn btn-primary">View Workshop</a>
        </div>
    {% else %}
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <div class="text-center mb-6">
                    <div class="text-success text-6xl mb-4">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-900">Confirm Your Spot</h1>
                    <p class="text-lg text-gray-600 mt-2">A spot has opened up in this workshop!</p>
                </div>
                
                <!-- Workshop Details -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h2 class="text-xl font-semibold text-blue-900 mb-4">Workshop Details</h2>
                    <div class="space-y-3">
                        <div class="flex items-start">
                            <i class="fas fa-chalkboard-teacher text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Workshop:</span>
                                <span class="ml-2 text-blue-700">{{ workshop.title }}</span>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-calendar text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Date:</span>
                                <span class="ml-2 text-blue-700">{{ session.start_datetime|date:"l, F j, Y" }}</span>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-clock text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Time:</span>
                                <span class="ml-2 text-blue-700">{{ session.start_datetime|time:"g:i A" }} - {{ session.end_datetime|time:"g:i A" }}</span>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-user text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Instructor:</span>
                                <span class="ml-2 text-blue-700">{{ workshop.instructor.display_name }}</span>
                            </div>
                        </div>
                        
                        {% if session.location %}
                        <div class="flex items-start">
                            <i class="fas fa-map-marker-alt text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Location:</span>
                                <span class="ml-2 text-blue-700">{{ session.location }}</span>
                            </div>
                        </div>
                        {% endif %}
                        
                        {% if session.meeting_url %}
                        <div class="flex items-start">
                            <i class="fas fa-video text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <span class="font-medium text-blue-800">Meeting URL:</span>
                                <a href="{{ session.meeting_url }}" class="ml-2 text-blue-600 underline" target="_blank">Join Session</a>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Deadline Warning -->
                {% if promotion %}
                <div class="alert alert-warning mb-6">
                    <div>
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Important:</strong> You must confirm by {{ promotion.expires_at|date:"F j, Y" }} at {{ promotion.expires_at|time:"g:i A" }}.
                            <br>If you don't confirm by then, this spot will be offered to the next person on the waitlist.
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Workshop Description -->
                {% if workshop.description %}
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-2">About This Workshop</h3>
                    <p class="text-gray-700">{{ workshop.description|linebreaks }}</p>
                </div>
                {% endif %}
                
                <!-- Action Buttons -->
                <div class="card-actions justify-center">
                    <form method="post" class="inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success btn-lg">
                            <i class="fas fa-check mr-2"></i>
                            Confirm My Registration
                        </button>
                    </form>
                    
                    <a href="{% url 'workshops:detail' workshop.slug %}" class="btn btn-outline btn-lg">
                        <i class="fas fa-arrow-left mr-2"></i>
                        Back to Workshop
                    </a>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}